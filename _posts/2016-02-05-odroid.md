---
layout: post
title: ODROID U2를 이용한 토렌트서버 및 미디어센터 사용
categories: [개인]
tags: [정보]
description: 구축과정은 다음 포스팅에서...
comments: true
---

# ODROID U2를 이용한 토렌트서버 및 미디어센터 

## 개요

- 임베디드보드 ODROID U2를 이용하여 토렌트 서버 구축
- ODROID나 RasberryPi를 이용하여 XBMC미디어센터 구축
- 스마트폰을 이용하여 토렌트파일 업로드 및 다운, 미디어 재생
- 이를 활용하여 애니, 드라마, 영화, 사진, 음악 등 HDMI를 지원하는 디스플레이에서 감상


### 실제 우리집에서 사용하는 구조

<img src="/assets/media/ODROID/struct1.png">

- 내 집의 경우 SK브로드밴드를 사용하며 현관 입구의 공유기에서 192.168.25.x대역의 ip를 제공
- 내 방의 공유기는 ipTime제품으로 192.168.0.x DHCP서버기능
- 거실의 공유기도 마찬가지 (TV에 연결된 셋톱박스와 같은 역할을 하는 라즈베리파이 OSMC)
- 보통의 경우 고정IP가 아니기 때문에 두 장비가 같은 내부망에 걸리도록 설정
- 내 방에 설치된 토렌트서버와 거실의 TV에 연결된 미디어센터의 통신을 위해 개선 필요
- 글을 참고하는 분의 집 네트워크 구조에 맞게 설정해주셔야함
- 보통 포트포워딩이나 공유기의 DHCP를 중지하여 게이트기능으로 사용
- TV의 usb단자와 HDMI단자를 라즈베리파이의 전원과 microHDMI단자에 연결하여 사용
- TV를 켤 때 같이 전원이 들어와 XBMC미디어센터 시작. 전원끄면 같이 꺼짐

<img src="/assets/media/ODROID/myodroid.png">

- 내 방의 odroid보드의 torrent서버에서 파일 다운

<img src="/assets/media/ODROID/raspberry1.jpg">
<img src="/assets/media/ODROID/raspberry2.jpg">
<img src="/assets/media/ODROID/connect.jpg">

- TV에 연결된 raspberry파이를 통해 odroid의 미디어 재생

<img src="/assets/media/ODROID/remote1.png">

- 스마트폰 앱을 통해 TV에 연결된 미디어센터 제어

<img src="/assets/media/ODROID/smart3.png">

- 스마트폰의 FTP연결 앱을통해 내방 서버의 동영상 스마트폰에서 고화질로 볼 수 있음


### 2개의 보드를 사용하는 이유

- 1개의 보드에서 토렌트서버와 미디어센터를 같이 운영할 수 있음
- 우리집 TV의 경우 ODROID U2의 LUbuntu 14.04버전의 XBMC (버전까먹음)에서 해상도 지원 x
- 라즈베리파이의 운영체제를 Rasbmc로 설치하여 동작하니 잘됨
- 라즈베리파이에 토렌트서버 다시 구축하기 귀찮아 그냥 2개를 사용해버림 
- 현재 자취방에서는 U2보드 한 대로 모니터에 연결하여 토렌트서버와 미디어센터로 사용중

## 사용되는 장비 및 용어 정리

- 기억에 의존하여 작성 한 것으로 대충 개요정도만 이해하시고 자세한 내용은 검색해주세요

### ODROID 

<img src="/assets/media/ODROID/odroid.PNG">

- 스펙은 위 이미지와 같음
- 삼성 겔럭시S2인가 3에서 사용된 EXynos4412칩 사용
- Ubuntu운영체제를 odroid에 최적화 시킨 Linaro우분투 사용
- 현재 LUbuntu14.04 LTS사용 중
- 토렌트서버, 미디어센터, SMB, FTP, WEB서버 등 다양하게 운영 가능
- 초기 라즈베리파이가 시장을 독점하였지만 ubuntu기반으로 저렴한 가격으로 안드로이드도 지원하며 전 세계적으로 사용중
- Hardkernel사이트에 가면 개발과 관련된 포럼들 많음 -> 여러 정보 얻을 수 있음

### RaspberryPi

<img src="/assets/media/ODROID/raspberry.PNG">

- 스펙은 위 이미지와 같음
- 기본적인 Rasbian운영체제 사용
- openelec, raspbmc, obmc 외 여러 운영체제 지원
- 내가 원하는 동작에 특화된 운영체제 선택하여 사용하면 됨
- 저렴한 가격과 꾸준히 사용되며 지속적인 유지보수가되어 개인적으로 odroid보다 안정적이라 생각함
- ODROID의 경우 새로운 보드를 꾸준히 출시하는데 모토가 기본베이스를 출시하면 사용자들이 함께 테스트해가며 보안한다는 정책을 가짐 (개발용으로 판매한다고 일정부분 사용자들에게 책임을 넘김... 기분탓인가)
- 둘 다 장단점이 있으니 알아서 선택하시길

### XBMC

- XBox Media Center의 약자
- XBOX에 구동되도록 만든 미디어플레이어
- 현재 안드로이드, 여러 리눅스에서 많이 사용
- AddOn이라는 모듈을 xbmc에 붙여서 사용가능
- python으로 개발되며 xbmc양식에 맞게 배포 가능
- 오픈소스로 소스코드는 c로 작성된 것으로 알고있음
- youtube, TV, cnn뉴스, web 등 무료이며 기본 배포되는 addon을 이용하여 응용할 수 있는게 많음
- 직접 애드온을 만들어 사용가능
- 스마트폰에서 리모콘 기능 제공 (정말 많은 기능이 있는데 내가 사용한 기능이 적음)
- 무료로 사용하는 스마트폰의 Remote Controller앱은 스마트폰의 파일 업로드기능 제공 안함
- 그래서 나의 경우 애드온을 만들어 파일업로드기능을 추가. 
- 추가적인 기능으로 한 모니터에서 전자앨범을 만들고 싶어 리스트를 내가 설정해서 사진과 동영상, 음악 등 순서에 맞게 재생되도록 애드온 개발
- 곰플레이어와 연결해 자동자막찾기, 가사찾기 등 여러기능 지원됨 
- 많은 기능을 이용하기위해 여러가지 찾아보길 바람 (오픈소스로 외국에서 개발이 활발해 공유된 스킨이나 애드온이 많음)

### OSMC

- 라즈베리파이에서 Rspbmc의 진화된 xbmc특화 운영체제로 알고 있음
- 나도 까먹고 있었는데 다시보니 Raspbmc가아닌 OSMC를 사용 중 

### transmisson

- 데비안 계열에서 토렌트 기능을 제공하는 것으로 알고 있음
- 9091포트를 기본으로 사용하며 웹, 스마트폰에서 접근 가능
- 설정 파일에서 최대 피어수, 동시 다운 파일 수, 업로드 수, id, pwd, port 등 다양한 설정 가능
- 속도를 최대한으로 내기위한 세팅이 있음 좋음 (자세한 건 까먹음) -> 하드웨어나 네트워크 스펙에 맞게 설정
- transmisson-gtk는 gui프로그램으로 시작 프로그램 등록이 까다롭고 재부팅 전 가지 파일목록 지워지는게 안되는 버그가 나 같은 경우 있음
- transmission-deamon의 경우 /etc/init.d에 시작 스크립트를 두고 rc.local에서 등록하여 시작 프로그램 등록이 수월하며 버그가 없음. 하지만 설정 파일 수정이 gui보다 좀 더 까다로움
- 나의경우 데몬을 사용
- 스마트폰에서 다운 가능 -> 원격으로 제어 가능 (업로드, 삭제 등)

### openelec

-  Open Embedded Linux Entertainment Center의 약자
-  운영체제의 하나로 XBMC구동만을 목적으로 한 운영체제
-  XBMC에 최적화 되어 전체 운영체제 크기가 150M인가 엄청 적었음
-  부팅 속도나 재생에 있어 효율적이라고 함 (하드웨어가속 가능)
-  하지만 내가 4대의 모니터에서 실험했을 때 1대의 모니터와 우리집 TV에서 실행 안됬음
-  openelec에서도 확장해서 토렌트서버 운영가능하지만 XBMC에 특화된 만큼 뭔가 불안했음
-  처음에 요 놈을 사용하려다 포기... 

### Raspbmc

- 라즈베리파이의 운영체제 중 하나
- 미디어 센터인 XBMC에 특화된 운영체제
- XBMC기능 외의 기본적인 여러 라즈베리파이 기능 제공
- openelec보다는 좀 더 범용적
- 기본 라즈베리파이 운영체제인 raspbian(?)보다는 확실히 빨랐음
- 실제 테스티 시 부팅속도나 재생속도의 차이는 없었음 (가끔은 요놈이 더 빨랐음)
- 스트리밍제어와 해상도 지원에 특화 된 것으로 알고있는데 자세한 내용은 검색해주세요..
- 나의 경우 요놈을 사용해 TV에 미디어를 재생하도록 


## 동작 순서

### 1. Torrando앱을 이용한 토렌트서버 연결

<img src="/assets/media/ODROID/setting.png">

- torrent서버의 ip주소 셋팅 (9091포트)


### 2. 스마트폰을 이용한 ODROID 토렌트서버에 업로드

<img src="/assets/media/ODROID/account.png">

- 스마트폰의 .torrent파일을 Toraando앱을 이용해 업로드

### 3. TV에 연결된 XBMC에서 파일 재생

<img src="/assets/media/ODROID/osmc.jpg">

- 위 이미지는 부팅화면 

<img src="/assets/media/ODROID/main.jpg">

- 위 이미지는 시작 화면 (한글 설정 및 스킨설정은 따로 해줘야함)

<img src="/assets/media/ODROID/remote2.png">

- TV에 연결된 미디어센터의 ip주소로 원격 설정
- yatse라는 무료 앱 이용중
- 일부기능 유료


<img src="/assets/media/ODROID/ftp.jpg">

- 파일은 odroid에 들어있음
- 재생 파일 위치를 ftp로 torrent서버의 다운받은 폴더 위치를 잡아줌
- 재생 시 xbmc에서 스트리밍으로 해당 파일 재생 (버퍼 거의 없음)
- 저작권 같은거에 걸릴 것 같아 실행화면은 생략


## 마치며

- 이번 포스팅은 이런 것 이 있고 내가 어떻게 사용하고 있는지 포스팅했음
- 대학교 다닐 때 학교에서 받은 장비가 남아돌았고 이 것을 이용해 무언가를 하고싶었음
- 처음에 단순 ftp서버로만 사용
- torrent를 여기서 다운하면 전력소모가 적어(5V 2A) 전기세를 아낄 수 있다 생각하여 토렌트서버로
- 다운 받은 내용을 컴퓨터에서 보지 말고 TV나 모니터에서 컴퓨터 본체 없이 원격조종해서 보고 싶었음
- XBMC를 알게되어 미디어센터로 동작
- 구축 과정과 addon만드는 과정 및 소스코드는 다음에 시간이 된다면 포스팅 하겠음
- 기억이 안나서 시간이 오래 걸릴 것 같음 (IQ가 낮아요)
- 정말 빙산의 일각정도 사용했지만 지식 공유나 나 같은 오덕들에게 도움이 될 것 같아 포스팅
- 추가로... 책 받고 싶어요 이 글 보신분들... 저에게 한 표 부탁드립니다 ㅎㅎ


### Tips

- Youtube영상은 스마트폰에서 공유하기버튼 누르고 Yaste 미디어센터로 공유하면 알아서 스트리밍재생함. (youtube addon설치 후 가능) : TV에서 큰 사이즈로 볼 수 있음 (고화질추천)
- 페이스북도 영상도 가능
- emmc나 sdcard, microSdcard의 용량대비 가격이 비쌈
- 많은 파일을 다운받아 저장하고 싶을 경우 외장하드 사용 추천
- 조심 할 점은 보통의 보드에서 usb (2.0,3.0 등)를 지원해도 보드의 전체 절력은 5v 2A, 공유기는 12V 5A 정도. 
- 이 중 전원 단자의 커패시터를 통해 전류가 손실됨. 실 측정시 1.2~1.5 A 사용 (기억이가물)
- 따라서 외장하드도 별도의 전원을 따로 사용하는 것 을 추천한다. 
- 오드로이드, 라즈베리파이, 아두이노 등 에서 자체 전력만으로 외장하드 인식 안됬음 (종류마다 다를 수 도)
- mount가 귀찮다면 openwrt쪽에서 사용되었던 boot어쩌구 기법이 있는데 외장메모리와 시스템 메모리를 하나로 합쳐 논리적으로 하나의 하드처럼 사용. 외장하드가 운영체제가 올라간 하나의 메모리로 사용될 수 있다. 이게 더 귀찮음... 설정은 어렵지만 한 번 하면 편함 (지금은 기억이 안남..)